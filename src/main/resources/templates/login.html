<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <title>网络云盘</title>
    <link rel="stylesheet" href="/css/loginStyle.css">
    <script src="/js/jquery.min.js"></script>

</head>

<body>
<div class="content">
    <div class="form sign-in">
        <form id="logUser" name="loginForm">
            <h2>欢迎回来</h2>
            <label>
                <span>账号</span>
                <input id="logUsername" name="username"/>
            </label>
            <label>
                <span>密码</span>
                <input id="logPassword" name="password"/>
            </label>
            <p class="forgot-pass"><a href="/OnlineCommunity/login/passwordBack">忘记密码？</a></p>
            <label>
                <span th:text="${loginError1}"></span>
            </label>
            <button type="button" class="submit" onclick="login()">登 录</button>
        </form>
    </div>
    <div class="sub-cont">
        <div class="img">
            <div class="img__text m--up">
                <h2>还未注册？</h2>
                <p>立即注册，加入我们吧！</p>
            </div>
            <div class="img__text m--in">
                <h2>已有帐号？</h2>
                <p>有帐号就登录吧，好久不见了！</p>
            </div>
            <div class="img__btn">
                <span class="m--up">注 册</span>
                <span class="m--in">登 录</span>
            </div>
        </div>
        <div class="form sign-up">
            <form id="regUser" name="registerForm">
                <h2>立即注册</h2>
                <label>
                    <span>账号</span>
                    <input id="regUsername" name="username"/>
                </label>
                <label>
                    <span>密码</span>
                    <input id="regPassword" name="password"/>
                </label>
                <label>
                    <span>邮箱</span>
                    <input id="regEmail" name="email"/>
                </label>
                <label>
                    <span>电话号码</span>
                    <input id="regPhone" name="phone"/>
                </label>
                <button type="button" class="submit" onclick="register()">注 册</button>
            </form>
        </div>
    </div>
</div>
<script src="/js/loginScript.js"></script>
<script>
    function indexLogin() {
        window.location.href = "login";
    }

    function register() {
        if ($("#regUsername").value === '') {
            alert("用户名不能为空，请重新输入！");
            $("#regUsername").focus();
            return;
        }
        if ($("#regEmail").value === '') {
            alert("邮箱不能为空，请重新输入！");
            $("#regEmail").focus();
            return;
        }
        if ($("#regPhone").value === '') {
            alert("电话号码不能为空，请重新输入！");
            $("#regPhone").focus();
            return;
        }
        //使用jquery的serializeArray方法，和springBoot的自动参数绑定
        var formData = $("#regUser").serializeArray();
        $.ajax({
            url: 'register',
            type: 'POST',
            data: formData,
            success: function (data) {
                alert(data);
                setTimeout("indexLogin()", 1500);
            }
        })
    }

    function login() {
        if ($("#logUsername").value === '') {
            alert("用户名不能为空，请重新输入！");
            $("#logUsername").focus();
            return;
        }
        if ($("#logPassword").value === '') {
            alert("密码不能为空，请重新输入！");
            $("#logPassword").focus();
            return;
        }
        //使用jquery的serializeArray方法，和springBoot的自动参数绑定
        var formData = $("#logUser").serializeArray();
        $.ajax({
            url: 'login',
            type: 'POST',
            data: formData,
            success: function (data) {
                if (data == "用户名不存在，请注册！") {
                    alert(data);
                } else if (data == "用户名或密码错误，请重新输入！") {
                    alert(data);
                    $("#logPassword").val("");
                    $("#logPassword").focus();
                } else {
                    alert(data);
                    window.location.href = "index"
                }
            }
        })
    }
</script>
</body>

</html>
